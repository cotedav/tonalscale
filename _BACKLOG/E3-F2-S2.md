# E3-F2-S2 Blend mode, strength, and saturation controls wired to reactive state

## User Story

As a designer, I want blend mode and tonal shaping controls in Vue so I can tweak overlays, peaks, spreads, and saturation curves with instant feedback.

## Related Epic

- [E3](./E3.md) – Tonal scale builder migration epic.

## Related Feature

- [E3-F2](./E3-F2.md) – Color input and blending control surfaces feature.

## Scope

- Implement dropdowns and sliders/number inputs for blend mode selection, blend strength, peak, spread, and per-side saturation (dark/light) with bi-directional sync.
- Include validation for numeric ranges used by blend algorithms and tone shaping curves.
- Wire control changes to the tonal generation composables for immediate scale regeneration.
- Provide default presets mirroring the prototype defaults for new sessions.
- Break the prototype’s tight coupling—controls should bind to a typed store/composable layer instead of invoking `updateScale()` directly from DOM listeners, so validation and orchestration stay centralized.【F:temp/src/js/index.js†L161-L187】【F:temp/src/js/index.js†L433-L438】

## Acceptance Criteria

- All controls render with Tailwind styling and reflect current state values; adjusting sliders updates paired number inputs and vice versa.
- Blend modes cover dodge, overlay, soft/hard light, darken/lighten, multiply/screen, color burn/dodge, vivid light, and hue replacement options.
- Inputs enforce valid ranges and prevent invalid payloads from dispatching to the engine; invalid states surface inline errors.
- Control events update shared state, and the tonal engine listens to that state rather than DOM events—no component should call the generator directly.
- Unit tests verify control-to-state wiring and boundary validation for peak/spread/saturation parameters.

## Notes

- Control sets, defaults, and feedback must match the `temp/` prototype exactly; implement with Tailwind/Headless UI while porting existing behaviors rather than inventing new ones.
- Add guardrails so blending graph rendering and state updates are resilient if scale data is not yet available, instead of assuming `State.getScaleData()` exists as in the prototype’s monolithic file.【F:temp/src/js/index.js†L187-L265】【F:temp/src/js/index.js†L433-L520】
