# E3-F3-S2 Expose reusable composables/services for tonal scale state and derivations

## User Story

As a developer, I want composables that manage tonal scale parameters and derived data so UI components can reactively consume consistent state.

## Related Epic

- [E3](./E3.md) – Tonal scale builder migration epic.

## Related Feature

- [E3-F3](./E3-F3.md) – Tonal generation and color math engine feature.

## Scope

- Create a Pinia store or composables to hold base/blend colors, blend mode settings, tone shaping parameters, and generated scale data.
- Expose computed properties for tonal strips (full 0–100, extended key subset, key subset) and metadata such as nearest AA/AAA candidates per index.
- Provide actions for updating parameters, loading defaults, and importing/exporting state payloads.
- Ensure composables notify subscribers for URL sync, clipboard, and visualization layers.

## Acceptance Criteria

- Components can import composables to read/update tonal parameters without duplicating logic or accessing raw utilities directly.
- Derived getters produce all subsets and metadata needed by visualization and accessibility features (indices, hex values, base luminance marker, contrast candidates).
- State updates debounced/throttled as needed to keep UI responsive during slider drags while preserving accuracy.
- Unit tests validate state mutations, derived data correctness, and serialization/deserialization hooks.

## Notes

- Model the store/composables on the flows in `temp/`, preserving parameters, derivations, and serialization semantics so the migration remains a faithful port onto the modern scaffold.
